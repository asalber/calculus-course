% Author: Alfredo SÃ¡nchez Alberca (asalber@ceu.es)
\begin{tikzpicture}
  \begin{axis}[view={120}{20},
  gen3dfun,
  xmin=-1.5, xmax=1.5,
  ymin=-1.5, ymax=1.5,
  zmin=-0.2, zmax=4,
  axis x line=middle,
  axis y line=middle,
  axis z line=middle,
%  axis equal=true,
  every axis x label/.style={at={(xticklabel* cs:1.1)}},
  every axis y label/.style={at={(yticklabel* cs:1.1)}},
  every axis z label/.style={at={(zticklabel* cs:1.1)}},
  x tick label style={anchor=east, inner sep=2pt}, 
  y tick label style={anchor=north, inner sep=5pt},
  z tick label style={anchor=east, inner sep=2pt},  
  xtick={1},
  xticklabels={$x_0$},
  ytick={1},
  yticklabels={$y_0$}, 
  ztick={2},
  zticklabels={}{$f(x_0,y_0)$},
  mesh/interior colormap name=incolormap,
  colormap name=outcolormap,
  clip=false,
  height=5cm,
  width=5cm,
  ]
  \addplot3[surf, domain=-1.5:1.5, y domain=-1.5:1, faceted color=color1, samples=30, samples y=30, shader=interp] {x^2+y^2/2};
  \coordinate (O) at (0,0,0);
  \coordinate (P) at (1,1,1.5);
  \coordinate (Pxy) at (1,1,0);
  \addplot3[gray, fill=gray, opacity=0.8] coordinates{(0,0,0) (2,2,0) (2,2,5) (0,0,5)};
%  \addplot3[surf, domain=-1.5:1.5, y domain=1:1.5, faceted color=color1, samples=30, samples y= 5, shader=interp] {x^2+y^2/2};
  \fill (P) circle (1.2pt) ;
  \addplot3[domain=0.5:1.8, samples y=0] ({x},{x},{x^2+x^2/2});
  \draw[color2, dotted] (P) -- (Pxy);
  \draw[color2, dotted] (Pxy) -- (1,0,0);
  \draw[color2, dotted] (Pxy) -- (0,1,0);
  \draw[color2, dotted] (P) -- (0,0,2);
  \end{axis}
\end{tikzpicture}
